C51 COMPILER V9.00   TIMER                                                                 01/15/2025 09:25:09 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN .\Debug\Timer.obj
COMPILER INVOKED BY: E:\KEIL\KEIL4\C51\BIN\C51.EXE ..\User\source\Hardware\Timer.c LARGE OMF2 BROWSE INCDIR(..\FU68xx_Ha
                    -rdware_Driver\Include;..\User\include) DEBUG PRINT(.\Listings\Timer.lst) OBJECT(.\Debug\Timer.obj)

line level    source

   1          /* --------------------------- (C) COPYRIGHT 2021 Fortiortech ShenZhen -----------------------------
   2              File Name      : TIMER.c
   3              Author         : Lewis.wang
   4              Version        : V1.0
   5              Date           : 2021-12-04
   6              Description    : This file contains Timer function used for Motor Control.
   7          ----------------------------------------------------------------------------------------------------
   8                                                 All Rights Reserved
   9          ------------------------------------------------------------------------------------------------- */
  10          
  11          #include <FU68xx_4_MCU.h>
  12          #include <Myproject.h>
  13          /* -------------------------------------------------------------------------------------------------
  14              Function Name  : Timer2_Init
  15              Description    : Timer2åˆå§‹åŒ–
  16              Date           : 2021-12-04
  17              Parameter      : None
  18          ------------------------------------------------------------------------------------------------- */
  19          void Timer2_Init(void)
  20          {
  21   1          ClrBit(TIM2_CR1, T2CEN);
  22   1          SetReg(TIM2_CR0, T2PSC0 | T2PSC1 | T2PSC2, T2PSC0 | T2PSC1 | T2PSC2);    //000-->24M    001-->12M   01
             -0-->6M    011-->3M 100-->1.5M 101-->750K  110-->375K  111-->187.5K
  23   1          SetReg(TIM2_CR0, T2MOD0 | T2MOD1, T2MOD0);
  24   1          ClrBit(TIM2_CR0, T2CES);
  25   1          ClrBit(TIM2_CR1, T2IR | T2IF | T2IP);
  26   1          SetBit(TIM2_CR1, T2IFE);
  27   1          TIM2__ARR  = (TailWind_Time * TIM2_Fre / 1000);
  28   1          TIM2__DR   = TIM2__ARR;
  29   1          TIM2__CNTR = 0;
  30   1          SetBit(TIM2_CR1, T2CEN);
  31   1      }
  32          
  33          /* -------------------------------------------------------------------------------------------------
  34              Function Name  : Timer3_Init
  35              Description    : Timer3åˆå§‹åŒ–
  36              Date           : 2021-12-04
  37              Parameter      : None
  38          ------------------------------------------------------------------------------------------------- */
  39          void Timer3_Init(void)
  40          {
  41   1          SetBit(PH_SEL, T3SEL);                        //Timer3ç«¯å£ä½¿èƒ½
  42   1          SetBit(PH_SEL1, T3CT);                        //é»˜è®¤ç«¯å£ä¸ºP11,åŠŸèƒ½è½¬ç§»åŽä¸ºP01,éœ€TIMER4è½¬ç
             -§»åˆ°P00
  43   1          ClrBit(TIM3_CR0, T3PSC2);                     //è®¡æ•°å™¨æ—¶é’Ÿåˆ†é¢‘é€‰æ‹©
  44   1          ClrBit(TIM3_CR0, T3PSC1);                     //000-->24M   001-->12M   010-->6M    011-->3M
  45   1          ClrBit(TIM3_CR0, T3PSC0);                     //100-->1.5M  101-->750K  110-->375K  111-->187.5Kï¼ˆæ³¨
             -æ„ï¼šTimer3åœ¨è¾“å…¥æ•èŽ·æ¨¡å¼ä¸‹ 111å¯¹åº”çš„æ˜¯48MHZï¼Œå…¶ä»–æ¨¡å¼å¯¹åº”187.5kï¼‰
  46   1          ClrBit(TIM3_CR0, T3OCM);
  47   1          ClrBit(TIM3_CR0, T3IRE);                        //æ¯”è¾ƒåŒ¹é…ä¸­æ–­/è„‰å®½æ£€æµ‹ä¸­æ–­0-->Disable  1-
             -->Enable
  48   1          ClrBit(TIM3_CR0, T3OPM);                        //0-->è®¡æ•°å™¨ä¸åœæ­¢ 1-->å•æ¬¡æ¨¡å¼
  49   1          SetBit(TIM3_CR1, T3IPE);                        //è¾“å…¥Timer PWMå‘¨æœŸæ£€æµ‹ä¸­æ–­ä½¿èƒ½ 0-->Disable 
             - 1-->Enable
C51 COMPILER V9.00   TIMER                                                                 01/15/2025 09:25:09 PAGE 2   

  50   1          SetBit(TIM3_CR1, T3IFE);                        //è®¡æ•°å™¨ä¸Šæº¢ä¸­æ–­ä½¿èƒ½ 0-->Disable  1-->Enable
  51   1          SetBit(TIM3_CR1, T3NM1);                      //è¾“å…¥å™ªå£°è„‰å®½é€‰æ‹©
  52   1          SetBit(TIM3_CR1, T3NM0);                        //00-->ä¸æ»¤æ³¢    01-->4cycles 10-->8cycles  11-->16
             -cycles
  53   1          TIM3__ARR = 0;
  54   1          TIM3__DR = 0;
  55   1          TIM3__CNTR = 1;
  56   1          PTIM31 = 0; 
  57   1          PTIM30 = 0;
  58   1          ClrBit(TIM3_CR0, T3MOD);                      //0-->Timeræ¨¡å¼  1-->è¾“å‡ºæ¨¡å¼
  59   1          SetBit(TIM3_CR1, T3EN);                       //TIM3ä½¿èƒ½    0-->Disable  1-->Enable
  60   1      }
  61          /* -------------------------------------------------------------------------------------------------
  62              Function Name  : Timer4_Init
  63              Description    : Timer4åˆå§‹åŒ–
  64              Date           : 2021-12-04
  65              Parameter      : None
  66          ------------------------------------------------------------------------------------------------- */
  67          void Timer4_Init(void)
  68          {
  69   1          SetBit(PH_SEL, T4SEL);                        //Timer4ç«¯å£ä½¿èƒ½
  70   1          SetBit(PH_SEL1, T4CT);                        //é»˜è®¤ç«¯å£ä¸ºP01,åŠŸèƒ½è½¬ç§»åŽä¸ºP00
  71   1          SetReg(TIM4_CR0, T4PSC2 | T4PSC1 | T4PSC0, T4PSC2);   //000-->24M      001-->12M       010-->6M    011
             --->3M
  72   1          //100-->1.5M   101-->750K      110-->375K  111-->187.5K
  73   1          SetBit(TIM4_CR0, T4OCM);
  74   1          ClrBit(TIM4_CR0, T4IRE);                        //æ¯”è¾ƒåŒ¹é…ä¸­æ–­/è„‰å®½æ£€æµ‹ä¸­æ–­0-->Disable  1-
             -->Enable
  75   1          ClrBit(TIM4_CR0, T4OPM);                        //0-->è®¡æ•°å™¨ä¸åœæ­¢ 1-->å•æ¬¡æ¨¡å¼
  76   1          ClrBit(TIM4_CR1, T4IPE);                        //è¾“å…¥Timer PWMå‘¨æœŸæ£€æµ‹ä¸­æ–­ä½¿èƒ½ 0-->Disable 
             - 1-->Enable
  77   1          SetBit(TIM4_CR1, T4IFE);                        //è®¡æ•°å™¨ä¸Šæº¢ä¸­æ–­ä½¿èƒ½ 0-->Disable  1-->Enable
  78   1          ClrBit(TIM4_CR1, T4NM1);                        //è¾“å…¥å™ªå£°è„‰å®½é€‰æ‹©
  79   1          ClrBit(TIM4_CR1, T4NM0);                        //00-->ä¸æ»¤æ³¢    01-->4cycles  10-->8cycles  11-->1
             -6cycles
  80   1          TIM4__DR = 5000;
  81   1          TIM4__ARR = 10000;
  82   1          TIM4__CNTR = 0;
  83   1          SetBit(TIM4_CR0, T4MOD);                        //0-->Timeræ¨¡å¼  1-->è¾“å‡ºæ¨¡å¼
  84   1          ClrBit(TIM4_CR1, T4EN);                         //TIM4ä½¿èƒ½    0-->Disable  1-->Enable
  85   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    181    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
